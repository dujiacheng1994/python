#coding:utf-8
from bs4 import BeautifulSoup
import re
import requests
import pandas as pd
zhixiashi = ["北京","上海","天津","重庆"]
fushengjishi = ['杭州','哈尔滨','长春','大连','青岛','厦门','宁波','广州','深圳','南京','武汉','沈阳','西安','成都','济南']
dijishi = ['石家庄','唐山','秦皇岛','邯郸','邢台','保定','张家口','承德','沧州','廊坊','衡水','太原','大同','阳泉','长治','晋城','朔州','晋中','运城','忻州','临汾','吕梁','呼和浩特','包头','乌海','赤峰','通辽','鄂尔多斯','呼伦贝尔','巴彦淖尔','乌兰察布','沈阳','大连','鞍山','抚顺','本溪','丹东','锦州','营口','阜新','辽阳','盘锦','铁岭','朝阳','葫芦岛','长春','吉林','四平','辽源','通化','白山','松原','白城','哈尔滨','齐齐哈尔','鸡西','鹤岗','双鸭山','大庆','伊春','佳木斯','七台河','牡丹江','黑河','绥化','南京','无锡','徐州','常州','苏州','南通','连云港','淮安','盐城','扬州','镇江','泰州','宿迁','杭州','宁波','温州','嘉兴','湖州','绍兴','金华','衢州','舟山','台州','丽水','合肥','芜湖','蚌埠','淮南','马鞍山','淮北','铜陵','安庆','黄山','阜阳','宿州','滁州','六安','宣城','池州','亳州','福州','厦门','莆田','三明','泉州','漳州','南平','龙岩','宁德','南昌','景德镇','萍乡','九江','抚州','鹰潭','赣州','吉安','宜春','新余','上饶','济南','青岛','淄博','枣庄','东营','烟台','潍坊','济宁','泰安','威海','日照','临沂','德州','聊城','滨州','菏泽','郑州','开封','洛阳','平顶山','安阳','鹤壁','新乡','焦作','濮阳','许昌','漯河','三门峡','南阳','商丘','信阳','周口','驻马店','武汉','黄石','十堰','宜昌','襄阳','鄂州','荆门','孝感','荆州','黄冈','咸宁','随州','长沙','株洲','湘潭','衡阳','邵阳','岳阳','常德','张家界','益阳','郴州','永州','怀化','娄底','广州','韶关','深圳','珠海','汕头','佛山','江门','湛江','茂名','肇庆','惠州','梅州','汕尾','河源','阳江','清远','东莞','中山','潮州','揭阳','云浮','南宁','柳州','桂林','梧州','北海','防城港','钦州','贵港','玉林','百色','贺州','河池','来宾','崇左','海口','三亚','三沙','儋州','成都','自贡','攀枝花','泸州','德阳','绵阳','广元','遂宁','内江','乐山','南充','眉山','宜宾','广安','达州','雅安','巴中','资阳','贵阳','六盘水','遵义','安顺','毕节','铜仁','昆明','曲靖','玉溪','保山','昭通','丽江','普洱','临沧','拉萨','日喀则','昌都','林芝','山南','那曲','西安','铜川','宝鸡','咸阳','渭南','延安','汉中','榆林','安康','商洛','兰州','嘉峪关','金昌','白银','天水','武威','张掖','平凉','酒泉','庆阳','定西','陇南','西宁','海东','银川','石嘴山','吴忠','固原','中卫','乌鲁木齐','克拉玛依','吐鲁番','哈密']
xianjishi = ['河北省','辛集市','藁城市','晋州市','新乐市','鹿泉市','遵化市','迁安市','武安市','南宫市','沙河市','涿州市','定州市','安国市','高碑店市','泊头市','任丘市','黄骅市','河间市','霸州市','三河市','冀州市','深州市','内蒙古','霍林郭勒市','满洲里市','牙克石市','扎兰屯市','根河市','额尔古纳市','丰镇市','锡林浩特市','二连浩特市','乌兰浩特市','阿尔山市','辽宁省','新民市','瓦房店市','普兰店市','庄河市','海城市','东港市','凤城市','凌海市','北镇市','大石桥市','盖州市','灯塔市','调兵山市','开原市','凌源市','北票市','兴城市','吉林省','九台市','榆树市','德惠市','舒兰市','桦甸市','蛟河市','磐石市','公主岭市','双辽市','梅河口市','集安市','临江市','大安市','洮南市','延吉市','图们市','敦化市','龙井市','珲春市','和龙市','黑龙江省','尚志市','双城市','五常市','讷河市','密山市','虎林市','铁力市','绥芬河市','宁安市','海林市','穆棱市','同江市','富锦市','北安市','五大连池市','安达市','肇东市','海伦市','江苏省','江阴市','宜兴市','邳州市','新沂市','金坛市','溧阳市','常熟市','张家港市','太仓市','昆山市','吴江市','如皋市','通州市','海门市','启东市','东台市','大丰市','高邮市','江都市','仪征市','丹阳市','扬中市','句容市','泰兴市','姜堰市','靖江市','兴化市','浙江省','建德市','富阳市','临安市','余姚市','慈溪市','奉化市','瑞安市','乐清市','海宁市','平湖市','桐乡市','诸暨市','上虞市','嵊州市','兰溪市','义乌市','东阳市','永康市','江山市','临海市','温岭市','龙泉市','安徽省','桐城市','天长市','明光市','界首市','宁国市','福建省','福清市','长乐市','永安市','石狮市','晋江市','南安市','龙海市','邵武市','武夷山','建瓯市','漳平市','建阳市','福安市','福鼎市','江西省','井冈山市','瑞昌市','丰城市','樟树市','德兴市','乐平市','瑞金市','高安市','南康市','贵溪市','湖北省','大冶市','丹江口市','洪湖市','石首市','松滋市','宜都市','当阳市','枝江市','老河口市','枣阳市','宜城市','钟祥市','应城市','安陆市','汉川市','麻城市','武穴市','赤壁市','广水市','仙桃市','天门市','潜江市','恩施市','利川市','山东省','章丘市','胶南市','胶州市','平度市','莱西市','即墨市','滕州市','龙口市','莱阳市','莱州市','招远市','蓬莱市','栖霞市','海阳市','青州市','诸城市','寿光市','安丘市','高密市','昌邑市','曲阜市','兖州市','邹城市','新泰市','肥城市','乳山市','文登市','荣成市','乐陵市','禹城市','临清市','河南省','巩义市','新郑市','新密市','登封市','荥阳市','中牟县','偃师市','汝州市','舞钢市','林州市','卫辉市','辉县市','沁阳市','孟州市','禹州市','长葛市','义马市','灵宝市','邓州市','永城市','项城市','济源市','湖北省','大冶市','丹江口市','洪湖市','石首市','松滋市','宜都市','当阳市','枝江市','老河口市','枣阳市','宜城市','钟祥市','应城市','安陆市','汉川市','麻城市','武穴市','赤壁市','广水市','仙桃市','天门市','潜江市','恩施市','利川市','河南省','浏阳市','醴陵市','湘乡市','韶山市','耒阳市','常宁市','武冈市','临湘市','汨罗市','津市市','沅江市','资兴市','洪江市','冷水江市','涟源市','吉首市','广东省','从化市','增城市','乐昌市','南雄市','台山市','开平市','鹤山市','恩平市','廉江市','雷州市','吴川市','高州市','化州市','信宜市','高要市','四会市','兴宁市','陆丰市','阳春市','英德市','连州市','普宁市','罗定市','广西自治区','岑溪市','东兴市','桂平市','北流市','宜州市','合山市','凭祥市','四川省','都江堰市','彭州市','邛崃市','崇州市','广汉市','什邡市','绵竹市','江油市','峨眉山市','阆中市','华蓥市','万源市','简阳市','西昌市','贵州省','清镇市','赤水市','仁怀市','铜仁市','毕节市','兴义市','凯里市','都匀市','福泉市','云南省','安宁市','宣威市','个旧市','开远市','景洪市','楚雄市','大理市','潞西市','瑞丽市','陕西省','兴平市','韩城市','华阴市','甘肃省','玉门市','敦煌市','临夏市','合作市','宁夏自治区','灵武市','青铜峡市','新疆自治区','石河子市','阿拉尔市','图木舒克市','五家渠市','吐鲁番市','哈密市','和田市','阿克苏市','喀什市','阿图什市','库尔勒市','昌吉市','阜康市','米泉市','博乐市','伊宁市','奎屯市','塔城市','乌苏市','阿勒泰市']
diqu = ['北京市','东城区','西城区','崇文区','宣武区','朝阳区','海淀区','丰台区','石景山区','房山区','通州区','顺义区','门头沟区','昌平区','大兴区','怀柔区','平谷区','密云县','延庆县','天津市','和平区','河东区','河西区','南开区','河北区','红桥区','塘沽区','汉沽区','大港区','东丽区','西青区','津南区','北辰区','武清区','宝坻区','宁河县','静海县','蓟县','河北省','石家庄市','长安区','桥东区','桥西区','新华区','井陉矿区','裕华区','井陉县','正定县','栾城县','行唐县','灵寿县','高邑县','深泽县','赞皇县','无极县','平山县','元氏县','赵县','辛集市','藁城市','晋州市','新乐市','鹿泉市','河北省','唐山市','路南区','路北区','古冶区','开平区','丰润区','滦县','滦南县','乐亭县','迁西县','玉田县','唐海县','遵化市','迁安市','河北省','邯郸市','邯山区','丛台区','复兴区','峰峰矿区','河北省','衡水市','桃城区','冀州市','深州市','饶阳县','枣强县','故城县','阜城县','安平县','景县','武强县','武邑县','河北省','秦皇岛市','市辖区','海港区','山海关区','北戴河区','昌黎县','卢龙县','抚宁县','青龙满族自治县','河北省','张家口市','市辖区','桥西区','桥东区','宣化区','下花园区','宣化县','康保县','张北县','阳原县','赤城县','沽源县','怀安县','怀来县','崇礼县','尚义县','蔚县','涿鹿县','万全县','河北省','邢台市','市辖区','桥西区','桥东区','南宫市','沙河市','邢台县','柏乡县','任县','清河县','宁晋县','威县','隆尧县','临城县','广宗县','临西县','内丘县','平乡县','巨鹿县','新河县','南和县','河北省','承德市','市辖区','双桥区','双滦区','鹰手营子矿区','承德县','兴隆县','隆化县','平泉县','滦平县','丰宁满族自治县','围场满族蒙古族自治县','宽城满族自治县','河北省','沧州市','市辖区','运河区','新华区','泊头市','任丘市','黄骅市','河间市','沧县','青县','献县','东光县','海兴县','盐山县','肃宁县','南皮县','吴桥县','孟村回族自治县','河北省','保定市','市辖区','新市区','南市区','北市区','涿州市','定州市','安国市','高碑店市','满城县','清苑县','涞水县','阜平县','徐水县','定兴县','唐县','高阳县','容城县','涞源县','望都县','安新县','易县','曲阳县','蠡县','顺平县','博野县','雄县','河北省','廊坊市','市辖区','安次区','广阳区','霸州市','三河市','固安县','永清县','香河县','大城县','文安县','大厂回族自治县','山西省','太原市','小店区','迎泽区','杏花岭区','尖草坪区','万柏林区','晋源区','清徐县','古交市','山西省','大同市','城区','矿区','南郊区','新荣区','大同县','天镇县','灵丘县','阳高县','左云县','广灵县','浑源县','山西省','晋城市','城区','高平市','泽州县','陵川县','阳城县','沁水县','山西省','朔州市','朔城区','平鲁区','山阴县','右玉县','应县','怀仁县','山西省','晋中市','榆次区','介休市','昔阳县','灵石县','祁县','左权县','寿阳县','太谷县','和顺县','平遥县','榆社县','山西省','长治市','城区','郊区','潞城市','长治县','长子县','平顺县','襄垣县','沁源县','屯留县','黎城县','武乡县','沁县','壶关县','山西省','阳泉市','城区','矿区','郊区','平定县','盂县','山西省','吕梁市','离石市','孝义市','汾阳市','文水县','中阳县','兴县','临县','方山县','柳林县','岚县','交口县','交城县','石楼县','山西省','忻州市','忻府区','原平市','代县','神池县','五寨县','五台县','偏关县','宁武县','静乐县','繁峙县','河曲县','保德县','定襄县','岢岚县','山西省','临汾市','尧都区','侯马市','霍州市','汾西县','吉县','安泽县','大宁县','浮山县','古县','隰县','襄汾县','翼城县','蒲县','永和县','乡宁县','曲沃县','洪洞县','山西省','运城市','盐湖区','河津市','永济市','闻喜县','新绛县','平陆县','垣曲县','绛县','稷山县','芮城县','万荣县','临猗县','夏县','内蒙古自治区','呼和浩特市','新城区','回民区','玉泉区','赛罕区','土默特左旗','托克托县','和林格尔县','清水河县','武川县','内蒙古自治区','包头市','东河区','昆都仑区','青山区','石拐区','白云矿区','九原区','土默特右旗','固阳县','达尔罕茂明安联合旗','内蒙古自治区','乌海市','海勃湾区','海南区','乌达区','内蒙古自治区','乌兰察布盟','集宁区','卓资县','化德县','商都县','兴和县','凉城县','察哈尔右翼前旗','察哈尔右翼中旗','察哈尔右翼后旗','四子王旗','丰镇市','内蒙古自治区','赤峰市','红山区','元宝山区','松山区','宁城县','林西县','喀喇沁旗','巴林左旗','敖汉旗','阿鲁科尔沁旗','翁牛特旗','克什克腾旗','巴林右旗','内蒙古自治区','通辽市','科尔沁区','霍林郭勒市','开鲁县','科尔沁左翼中旗','科尔沁左翼后旗','库伦旗','奈曼旗','扎鲁特旗','内蒙古自治区','巴彦淖尔市','临河区','五原县','磴口县','杭锦后旗','乌拉特中旗','乌拉特前旗','乌拉特后旗','内蒙古自治区','兴安盟','乌兰浩特市','阿尔山市','突泉县','扎赉特旗','科尔沁右翼前旗','科尔沁右翼中旗','内蒙古自治区','锡林郭勒盟','锡林浩特市','二连浩特市','多伦县','阿巴嘎旗','西乌珠穆沁旗','东乌珠穆沁旗','苏尼特左旗','太仆寺旗苏尼特右旗','正镶白旗','正蓝旗','镶黄旗','内蒙古自治区','阿拉善盟','阿拉善左旗','阿拉善右旗','额济纳旗','内蒙古自治区','鄂尔多斯市','东胜区','准格尔旗','乌审旗','伊金霍洛旗','鄂托克旗','鄂托克前旗','杭锦旗','达拉特旗','内蒙古自治区','呼伦贝尔市','海拉尔区','满洲里市','牙克石市','扎兰屯市','根河市','额尔古纳市','陈巴尔虎旗','阿荣旗','新巴尔虎左旗','新巴尔虎右旗','鄂伦春自治旗','莫力达瓦达斡尔族自治旗','鄂温克族自治旗','辽宁省','沈阳市','和平区','沈河区','大东区','皇姑区','铁西区','苏家屯区','东陵区','新城子区','于洪区','辽中县','康平县','法库县','新民市','辽宁省','抚顺市','新抚区','东洲区','望花区','顺城区','抚顺县','清原满族自治县','新宾满族自治县','辽宁省','丹东市','振兴区','元宝区','振安区','东港市','凤城市','宽甸满族自治县','辽宁省','营口市','站前区','西市区','鲅鱼圈区','老边区','大石桥市','盖州市','辽宁省','锦州市','太和区','古塔区','凌河区','凌海市','北宁市','黑山县','义县','辽宁省','大连市','西岗区','中山区','沙河口区','甘井子区','旅顺口区','金州区','瓦房店市','普兰店市','庄河市','长海县','辽宁省','辽阳市','白塔区','文圣区','宏伟区','太子河区','弓长岭区','灯塔市','辽阳县','辽宁省','鞍山市','铁东区','铁西区','立山区','千山区','海城市','台安县','岫岩满族自治县','辽宁省','铁岭市','市辖区','银州区','清河区','调兵山市','开原市','铁岭县','昌图县','西丰县','辽宁省','朝阳市','市辖区','双塔区','龙城区','凌源市','北票市','朝阳县','建平县','喀喇沁左翼蒙古族自治县','辽宁省','葫芦岛市','市辖区','龙港区','南票区','连山区','兴城市','绥中县','建昌县','辽宁省','阜新市','市辖区','海州区','新邱区','太平区','清河门区','细河区','彰武县','阜新蒙古族自治县','辽宁省','盘锦市','市辖区','双台子区','兴隆台区','盘山县','大洼县','辽宁省','本溪市','平山区','明山区','溪湖区','南芬区','本溪满族自治县','桓仁满族自治县','吉林省','长春市','南关区','宽城区','朝阳区','二道区','绿园区','双阳区','农安县','榆树市','吉林省','松原市','市辖区','宁江区','乾安县','长岭县','扶余县','前郭尔罗斯蒙古族自治县','吉林省','吉林市','船营区','昌邑区','龙潭区','丰满区','舒兰市','桦甸市','蛟河市','磐石市','永吉县','吉林省','四平市','铁西区','铁东区','公主岭市','双辽市','梨树县','伊通满族自治县','吉林省','辽源市','龙山区','西安区','东辽县','东丰县','吉林省','通化市','东昌区','二道江区','梅河口市','集安市','通化县','辉南县','柳河县','吉林省','白山市','八道江区','临江市','靖宇县','抚松县','江源县','长白朝鲜族自治县','吉林省','白城市','洮北区','大安市','洮南市','镇赉县','通榆县','吉林省','延边朝鲜族自治州','延吉市','图们市','敦化市','龙井市','珲春市','和龙市','安图县','汪清县','黑龙江省','哈尔滨市','道里区','南岗区','道外区','香坊区','太平区','动力区','平房区','呼兰县','依兰县','方正县','宾县','巴彦县','木兰县','通河县','延寿县','阿城市','双城市','尚志市','五常市','黑龙江省','大庆市','萨尔图区','红岗区','龙凤区','让胡路区','大同区','林甸县','肇州县','肇源县','杜尔伯特蒙古族自治县','黑龙江省','齐齐哈尔市','龙沙区','昂昂溪区','铁峰区','建华区','富拉尔基区','碾子山区','梅里斯达斡尔区','讷河市','富裕县','拜泉县','甘南县','依安县','克山县','泰来县','克东县','龙江县','黑龙江省','牡丹江市','爱民区','东安区','阳明区','西安区','绥芬河市','宁安市','海林市','穆棱市','林口县','东宁县','黑龙江省','佳木斯市','前进区','永红区','向阳区','东风区','郊区','同江市','富锦市','桦川县','抚远县','桦南县','汤原县','黑龙江省','黑河市','市辖区','爱辉区','嫩江县','逊克县','孙吴县','北安市','五大连池市','黑龙江省','大兴安岭地区','呼玛县','塔河县','漠河县','黑龙江省','双鸭山市','市辖区','尖山区','岭东区','四方台区','宝山区','集贤县','宝清县','友谊县','饶河县','黑龙江省','伊春市','市辖区','伊春区','带岭区','南岔区','金山屯区','西林区','美溪区','乌马河区','翠峦区','友好区','上甘岭区','五营区','红星区','新青区','汤旺河区','乌伊岭区','铁力市','嘉荫县','黑龙江省','绥化市','市辖区','北林区','安达市','肇东市','海伦市','绥棱县','兰西县','明水县','青冈县','庆安县','望奎县','黑龙江省','鹤岗市','兴山区','向阳区','工农区','南山区','兴安区','东山区','萝北县','绥滨县','黑龙江省','鸡西市','鸡冠区','恒山区','滴道区','梨树区','城子河区','麻山区','虎林市','密山市','鸡东县','黑龙江省','七台河市','桃山区','新兴区','茄子河区','勃利县','上海市','黄浦区','卢湾区','徐汇区','长宁区','静安区','普陀区','闸北区','虹口区','杨浦区','闵行区','宝山区','嘉定区','浦东新区','金山区','松江区','青浦区','南汇区','奉贤区','崇明县','江苏省','南京市','玄武区','白下区','秦淮区','建邺区','鼓楼区','下关区','浦口区','栖霞区','大厂区','雨花台区','江宁县','江浦县','六合县','溧水县','高淳县','江苏省','无锡市','崇安区','南长区','北塘区','锡山区','惠山区','滨湖区','江阴县','宜兴市','江苏省','南通市','崇川区','港闸区','海安县','如东县','启东市','如皋市','通州市','海门市','江苏省','常州市','天宁区','钟楼区','戚墅堰区','郊区','溧阳市','金坛市','武进市','江苏省','苏州市','沧浪区','平江区','金阊区','吴中区','相城区','常熟市','张家港市','昆山市','吴江市','太仓市','江苏省','徐州市','鼓楼区','云龙区','九里区','贾汪区','泉山区','丰县','沛县','铜山县','睢宁县','新沂市','邳州市','江苏省','连云港市','连云区','云台区','新浦区','海州区','赣榆县','东海县','灌云县','灌南县','江苏省','淮安市','清河区','清浦区','淮阴县','涟水县','洪泽县','盱眙县','金湖县','淮安市','江苏省','盐城市','沧城区','响水县','滨海县','阜宁县','射阳县','建湖县','盐都县','东台市','大丰市','江苏省','扬州市','市辖区','广陵区','邗江区','郊区','兴化县','高邮县','宝应县','江都县','泰县','仪征市','高邮市','江都市','江苏省','镇江市','京口区','润州区','丹徒县','句容县','丹阳市','扬中市','句容市','江苏省','泰州市','海陵区','高港区','兴化市','靖江市','泰兴市','姜堰市','江苏省','宿迁市','宿城区','宿豫县','沭阳县','泗阳县','泗洪县','浙江省','杭州市','上城区','下城区','江干区','拱墅区','西湖区','滨江区','萧山区','余杭区','桐庐县','淳安县','建德市','富阳市','临安市','浙江省','湖州市','市辖区','德清县','长兴县','安吉县','浙江省','嘉兴市','秀城区','秀洲区','海宁市','平湖市','桐乡市','嘉善县','海盐县','浙江省','绍兴市','越城区','诸暨市','上虞市','嵊州市','绍兴县','新昌县','浙江省','衢州市','柯城区','衢江区','江山市','龙游县','常山县','开化县','浙江省','金华市','婺城区','金东区','兰溪市','义乌市','东阳市','永康市','武义县','浦江县','磐安县','浙江省','宁波市','海曙区','江东区','江北区','镇海区','北仑区','鄞州区','余姚市','慈溪市','奉化市','宁海县','象山县','浙江省','温州市','鹿城区','龙湾区','瓯海区','瑞安市','乐清市','永嘉县','洞头县','平阳县','苍南县','文成县','泰顺县','浙江省','舟山市','定海区','普陀区','岱山县','嵊泗县','浙江省','台州市','椒江区','黄岩区','路桥区','临海市','温岭市','玉环县','天台县','仙居县','三门县','浙江省','丽水市','莲都区','龙泉市','缙云县','青田县','云和县','遂昌县','松阳县','庆元县','景宁畲族自治县','安徽省','合肥市','瑶海区','庐阳区','蜀山区','包河区','安徽省','芜湖市','镜湖区','新芜区','马塘区','鸠江区','芜湖县','南陵县','繁昌县','安徽省','淮南市','田家庵区','大通区','谢家集区','八公山区','潘集区','凤台县','安徽省','蚌埠市','中市区','东市区','西市区','郊区','怀远县','固镇县','五河县','安徽省','安庆市','迎江区','大观区','宜秀区','桐城市','宿松县','枞阳县','太湖县','怀宁县','岳西县','望江县','潜山县','安徽省','铜陵市','铜官山区','狮子山区','郊区','铜陵县','安徽省','黄山市','屯溪区','黄山区','徽州区','休宁县','歙县','祁门县','黟县','安徽省','池州市','贵池区','东至县','石台县','青阳县','安徽省','宣城市','宣州区','宁国市','广德县','郎溪县','泾县','旌德县','绩溪县','安徽省','六安市','金安区','裕安区','寿县','霍山县','霍邱县','舒城县','金寨县','安徽省','宿州市','埇桥区','萧县','泗县','砀山','灵璧县','安徽省','马鞍山市','雨山区','花山区','金家庄区','当涂县','安徽省','滁州市','市辖区','琅琊区','南谯区','天长市','明光市','全椒县','来安县','定远县','凤阳县','安徽省','淮北市','相山区','杜集区','烈山区','濉溪县','安徽省','阜阳市','颖州区','颖东区','颖泉区','界首市','临泉县','颖上县','阜南县','太和县','安徽省','毫州市','谯城区','利辛县','涡阳县','蒙城县','安徽省','巢湖市','居巢区','含山县','无为县','庐江县','和县','福建省','福州市','鼓楼区','台江区','仓山区','马尾区','晋安区','闽侯县','连江县','罗源县','闽清县','永泰县','平潭县','福清市','长乐市','福建省','厦门市','思明区','杏林区','湖里区','集美区','同安区','福建省','漳州市','芗城区','龙文区','云霄县','漳浦县','诏安县','长泰县','东山县','南靖县','平和县','华安县','龙海市','福建省','莆田市','城厢区','涵江区','荔城区','秀屿区','仙游县','福建省','南平市','延平区','建瓯市','邵武市','武夷山市','建阳市','松溪县','光泽县','顺昌县','浦城县','政和县','福建省','龙岩市','新罗区','漳平市','长汀县','武平县','上杭县','永定县','连城县','福建省','泉州市','鲤城区','丰泽区','洛江区','泉港区','石狮市','晋江市','南安市','惠安县','永春县','安溪县','德化县','金门县','福建省','三明市','梅列区','三元区','永安市','明溪县','将乐县','大田县','宁化县','建宁县','沙县','尤溪县','清流县','泰宁县','福建省','宁德市','蕉城区','福安市','福鼎市','寿宁县','霞浦县','柘荣县','屏南县','古田县','周宁县','江西省','南昌市','东湖区','西湖区','青云谱区','湾里区','郊区','青山湖区','南昌县','新建县','安义县','进贤县','江西省','吉安市','吉州区','青原区','峡江县','新干县','永丰县','泰和县','遂川县','万安县','安福县','永新县','江西省','新余市','渝水区','分宜县','江西省','九江市','浔阳区','庐山区','瑞昌市','九江县','星子县','武宁县','彭泽县','永修县','修水县','湖口县','德安县','都昌县','江西省','景德镇市','珠山区','昌江区','乐平市','浮梁县','江西省','萍乡市','安源区','湘东区','莲花县','上栗县','芦溪县','江西省','鹰潭市','月湖区','贵溪市','余江县','江西省','赣州市','章贡区','瑞金市','南康市','石城县','安远县','赣县','宁都县','寻乌县','兴国县','定南县','上犹县','于都县','龙南县','崇义县','信丰县','全南县','大余县','会昌县','江西省','抚州市','临川区','南丰县','乐安县','金溪县','南城县','东乡县','资溪县','宜黄县','广昌县','黎川县','崇仁县','江西省','宜春市','袁州区','丰城市','樟树市','高安市','铜鼓县','靖安县','宜丰县','奉新县','万载县','上高县','江西省','上饶市','信州区','德兴市','上饶县','广丰县','鄱阳县','婺源县','铅山县','余干县','横峰县','弋阳县','玉山县','万年县','山东省','济南市','历下区','市中区','槐荫区','天桥区','历城区','山东省','青岛市','市南区','市北区','四方区','黄岛区','崂山区','李沧区','城阳区','胶州市','即墨市','平度市','胶南市','莱西市','山东省','淄博市','张店区','淄川区','博山区','临淄区','周村区','桓台县','高青县','沂源县','山东省','枣庄市','市中区','薛城区','峄城区','台儿庄区','山亭区','滕州区','山东省','莱芜市','莱城区','钢城区','山东省','临沂市','兰山区','罗庄区','河东区','沂南县','郯城县','沂水县','苍山县','费县','平邑县','莒南县','蒙阴县','临沭县','山东省','东营市','东营区','河口区','垦利县','广饶县','利津县','山东省','烟台市','芝罘区','福山区','牟平区','莱山区','龙口市','莱阳市','莱州市','招远市','蓬莱市','栖霞市','海阳市','长岛县','山东省','泰安市','泰山区','岱岳区','新泰市','肥城市','宁阳县','东平县','山东省','德州市','德城区','乐陵市','禹城市','陵县','宁津县','齐河县','武城县','庆云县','平原县','夏津县','临邑县','山东省','滨州市','滨城区','邹平县','沾化县','惠民县','博兴县','阳信县','无棣县','山东省','潍坊市','潍城区','寒亭区','坊子区','奎文区','青州市','诸城市','寿光市','安丘市','高密市','昌邑市','昌乐县','临朐县','山东省','威海市','环翠区','乳山市','文登市','荣成市','山东省','济宁市','市中区','任城区','曲阜市','兖州市','邹城市','鱼台县','金乡县','嘉祥县','微山县','汶上县','泗水县','梁山县','山东省','聊城市','东昌府区','临清市','高唐县','阳谷县','茌平县','莘县','东阿县','冠县','山东省','菏泽市','牡丹区','鄄城县','单县','郓城县','曹县','定陶县','巨野县','东明县','成武县','河南省','郑州市','中原区','二七区','管城回族区','金水区','邙山区','河南省','平顶山市','新华区','卫东区','石龙区','湛河区','宝丰县','叶县','鲁山县','郏县','舞钢市','汝州市','河南省','鹤壁市','鹤山区','山城区','淇滨区','浚县','淇县','河南省','焦作市','解放区','中站区','马村区','山阳区','修武县','博爱县','武陟县','温县','沁阳市','孟州市','河南省','新乡市','新华区','红旗区','北站区','郊区','卫辉市','辉县市','新乡县','获嘉县','原阳县','长垣县','封丘县','延津县','河南省','濮阳市','华龙区','濮阳县','南乐县','台前县','清丰县','范县','河南省','开封市','鼓楼区','龙亭区','顺河回族区','南关区','郊区','开封县','尉氏县','兰考县','杞县','通许县','河南省','济源市','河南省','漯河市','源汇区','郾城县','临颍县','舞阳县','河南省','三门峡市','湖滨区','义马市','灵宝市','渑池县','卢氏县','陕县','河南省','许昌市','魏都区','禹州市','长葛市','许昌县','鄢陵县','襄城县','河南省','洛阳市','西工区','老城区','涧西区','瀍河回族区','洛龙区','吉利区','偃师市','孟津县','汝阳县','伊川县','洛宁县','嵩县','宜阳县','新安县','栾川县','河南省','周口市','川汇区','项城市','商水县','淮阳县','太康县','鹿邑县','西华县','扶沟县','沈丘县','郸城县','河南省','南阳市','卧龙区','宛城区','邓州市','桐柏县','方城县','淅川县','镇平县','唐河县','南召县','内乡县','新野县','社旗县','西峡县','河南省','安阳市','北关区','文峰区','殷都区','龙安区','林州市','安阳县','滑县','内黄县','汤阴县','河南省','驻马店市','驿城区','确山县','新蔡县','上蔡县','西平县','泌阳县','平舆县','汝南县','遂平县','正阳县','河南省','信阳市','浉河区','平桥区','潢川县','淮滨县','息县','新县','商城县','固始县','罗山县','光山县','河南省','商丘市','梁园区','睢阳区','永城市','宁陵县','虞城县','民权县','夏邑县','柘城县','睢县','湖北省','武汉市','江岸区','江汉区','乔口区','汉阳区','武昌区','青山区','洪山区','湖北省','黄石市','黄石港区','西塞山区','下陆区','铁山区','湖北省','十堰市','茅箭区','张湾区','郧县','郧西县','竹山县','竹溪县','房县','丹江口市','湖北省','襄樊市','襄城区','樊城区','襄阳县','南漳县','谷城县','保康县','老河口市','枣阳市','宜城市','湖北省','鄂州市','梁子湖区','华容区','鄂城区','湖北省','荆州市','沙市区','荆州区','公安县','临利县','江陵县','石首市','洪湖市','松滋市','湖北省','咸宁市','咸安区','赤壁市','嘉鱼县','通城县','崇阳县','通山县','湖北省','恩施土家苗族自治州','恩施市','利川市','建始县','来凤县','巴东县','鹤峰县','宣恩县','咸丰县','湖北省','宜昌市','西陵区','伍家岗区','点军区','猇亭区','夷陵区','宜都市','当阳市','枝江市','秭归县','远安县','兴山县','五峰土家族自治县','长阳土家族自治县','湖北省','黄冈市','黄州区','麻城市','武穴市','红安县','罗田县','浠水县','蕲春县','黄梅县','英山县','团风县','湖北省','孝感市','孝南区','应城市','安陆市','汉川市','云梦县','大悟县','孝昌县','湖北省','荆门市','东宝区','掇刀区','钟祥市','京山县','沙洋县','湖北省','随州市','曾都区','广水市','湖北省','仙桃市','湖北省','潜江市','湖北省','神农架林区','湖南省','长沙市','芙蓉区','天心区','岳麓区','开福区','雨花区','长沙县','望城县','宁乡县','浏阳市','湖南省','湘潭市','雨湖区','岳塘区','湘乡市','韶山市','湘潭县','湖南省','衡阳市','石鼓区','雁峰区','珠晖区','蒸湘区','南岳区','耒阳市','常宁市','衡阳县','衡东县','衡山县','衡南县','祁东县','湖南省','邵阳市','双清区','大祥区','北塔区','武冈市','邵东县','洞口县','新邵县','绥宁县','新宁县','邵阳县','隆回县','城步苗族自治县','湖南省','岳阳市','岳阳楼区','君山区','云溪区','临湘市','汨罗市','岳阳县','湘阴县','平江县','华容县','湖南省','常德市','武陵区','鼎城区','津市市','澧县','临澧县','桃源县','汉寿县','安乡县','石门县','湖南省','张家界市','永定区','武陵源区','慈利县','桑植县','湖南省','益阳市','赫山区','资阳区','沅江市','桃江县','南县','安化县','湖南省','郴州市','北湖区','苏仙区','资兴市','宜章县','汝城县','安仁县','嘉禾县','临武县','桂东县','永兴县','桂阳县','湖南省','永州市','冷水滩区','芝山区','祁阳县','蓝山县','宁远县','新田县','东安县','江永县','道县','双牌县','江华瑶族自治县','湖南省','娄底市','娄星区','冷水江市','涟源市','新化县','双峰县','湖南省','怀化市','鹤城区','洪江市','会同县','沅陵县','辰溪县','溆浦县','中方县','新晃侗族自治县','芷江侗族自治县','通道侗族自治县','靖州苗族侗族自治县','麻阳苗族自治县','湖南省','株洲市','天元区','荷塘区','芦淞区','石峰区','醴陵市','株洲县','炎陵县','茶陵县','攸县','湖南省','湘西土家族苗族自治州','吉首市','古丈县','龙山县','永顺县','凤凰县','泸溪县','保靖县','花垣县']
diqu = list(set(diqu))
changable_level = ['区委副书记','区委书记','市委副书记','市委书记','副市长','市长','区委书记','副区长','区长','市委常委','区委常委']
zhixiashi_level = {'区委副书记':'5','市委副书记':'7','区委常委':'6','县委常委':'6','市委常委':'7','区委书记':'6','副区长':'5','区长':'6','市委书记':'8','副市长':'7','市长':'8'}
fushengjishi_level = {'区委副书记':'4','市委副书记':'6','县委常委':'5','区委常委':'5','市委常委':'6','区委书记':'5','副区长':'4','区长':'5','市委书记':'7','副市长':'6','市长':'7'}
dijishi_level = {'区委副书记':'3','市委副书记':'5','县委常委':'4','区委常委':'4','市委常委':'5','区委书记':'4','副区长':'3','区长':'4','市委书记':'6','副市长':'5','市长':'6'}
other_level = {'区委副书记':'2','市委副书记':'4','县委常委':'3','区委常委':'3','市委常委':'4','区委书记':'3','副区长':'2','区长':'3','市委书记':'5','副市长':'4','市长':'5'}
def readData(uri):
    df = pd.read_excel("default.xlsx")
    array = df.values
    dict1 = {}
    for item in array:
        dict1[item[0]] = item[1]
    list1 = list(dict1.keys())
    return dict1,list1

dict1,list1 = readData("default.xlsx")   #读无歧义表
dict2,list2 = readData("gongqingtuan.xlsx")  #读共青团表

h = {
    "user-agent":"Mozilla/5.0 (MSIE 10.0; Windows NT 6.1; Trident/5.0)"   #模拟用户访问
}
#mylist = [['姓名','副科级','正科级','副处级','正处级','副厅级','正厅级','副部级','正部级','工作范围']]
mylist = []
for num in range(15000,15100):   #这里设置人物信息范围
    try:
        #获取数据
        #dir_url = "http://ldzl.people.com.cn/dfzlk/front/personPage6223.htm"
        if num%100 == 0: print(num)
        dir_url="http://ldzl.people.com.cn/dfzlk/front/personPage"+ str(num) + ".htm"
        res = requests.get(dir_url,headers = h)
        if res.status_code == 404: continue
        t = res.text
        soup = BeautifulSoup(t,"html.parser")   #解析返回的response
        dir_item = soup.find_all('div',attrs ={"class":"box01"})

        #初步整理数据格式，转化为list
        text = dir_item[0].text
        text = text.replace('\n', '=').replace('\r', '=').replace('\t','=')
        text = re.sub('[\u3000][\u3000]+', '=',text)
        text = text.replace('\u3000','').replace(' ','')
        text = re.sub("[=]+", "=", text)
        text = text.strip('=')
        a = text.split('=')
        b = a[0].split('，')
        del(a[0])
        b = b+a
        #识别每一条年份信息
        districts = set() #工作地点初始化
        tempinfo = b.copy()
        for i in range(len(b)):
            level = 0
            tiaomu = b[i]
            #筛选城市信息加入
            for city in diqu:
                if tiaomu.find(city)!=-1:
                    districts.add(city)
            #开始识别级别
            if(len(tiaomu)>=4):
                year = b[i][0:4]
                if not year.isdigit(): continue
            else: continue
            sector = re.split('，|、',tiaomu)
            for info in sector:
                #先找共青团关键字
                if info.find("共青团")!= -1:
                    for key in list2:
                        if(info.find(key)!=-1):
                            level = max(level,int(dict2[key]))
                            break
                else:
                    #开始识别替换dict1（无歧义表）
                    for key in list1:
                        if info.find(key)!= -1:
                            level = max(level,int(dict1[key]))
                            break
                    #开始试别具体省市（多种可能）
                    for key in changable_level:
                        flag = 0
                        if info.find(key)!=-1:
                            for city in zhixiashi:
                                if(tiaomu.find(city))!=-1:
                                    level = max(level,int(zhixiashi_level[key]))
                                    flag=1
                                    break
                            for city in fushengjishi:
                                if(tiaomu.find(city))!=-1:
                                    level = max(level,int(fushengjishi_level[key]))
                                    #print(tiaomu + info + key + str(level))
                                    flag=1
                                    break
                            for city in dijishi:
                                if(tiaomu.find(city))!=-1:
                                    level = max(level,int(dijishi_level[key]))
                                    #print(tiaomu+info+key+str(level))
                                    flag=1
                                    break
                            if flag==0:
                                level = max(level, int(other_level[key]))
                                #print(tiaomu + info + key + str(level))
                                flag=1
                                break
                        if flag==1:break
            #最终确定最高级别
            b[i] = year + '=' + str(level) #此处为已识别级别的中间结果
        #整理成合适格式
        newinfo = [b[0]] #存储改为1999=3这种格式的中间结果
        level = 0
        for i in range(1,len(b)):
            temp = b[i].split('=')
            if len(temp)==2:
                if int(temp[1])>int(level):
                    newinfo.append(b[i])
                    level = temp[1]
        newnewinfo = [b[0],'0','0','0','0','0','0','0','0']
        for i in range(1,len(newinfo)):
            temp = newinfo[i].split('=')
            newnewinfo[int(temp[1])] = temp[0]
        newnewinfo.append(','.join(districts))
    except Exception as e:
        print(str(num)+':')
        print(e)
        continue
    #mylist.append(newnewinfo)
    mylist.append(tempinfo)
df = pd.DataFrame(data=mylist)
df.to_csv("./resul11t.csv", encoding="utf-8-sig", mode="a", header=False, index=False)